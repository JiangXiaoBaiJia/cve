Mblog blog system has SSTI template injection vulnerability

#### Project Introduction:

#### Introduction

Mblog is an open-source and free blog system, developed in Java language, supporting mysql/h2 databases, and developed using popular frameworks such as spring-boot, jpa, shiro, bootstrap.

#### Vulnerability Introduction

Mblog has a security vulnerability that allows attackers to execute arbitrary code on the server.

#### Affected Versions:

mblog < 3.5.0

Star: 3.3K

#### Vulnerability Analysis

The mblog project's Freemarker template dependency version 2.3.29 has a template injection vulnerability.

https://github.com/JiangXiaoBaiJia/cve/blob/main/%E5%9B%BE%E7%89%871.png

In the theme management function, it is possible to upload theme zip packages.

https://github.com/JiangXiaoBaiJia/cve/blob/main/%E5%9B%BE%E7%89%872.png

Modifying the contents of a compressed file and adding a detection statement.

https://github.com/JiangXiaoBaiJia/cve/blob/main/%E5%9B%BE%E7%89%873.png

 

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png)And then enable the functionality.

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image010.png)

Access the homepage by directly visiting the index file since it contains the necessary content for the homepage.

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image012.png)

The malicious code from the corresponding index.elf file was loaded, successfully executing the "calc" command, which allows for arbitrary command execution.

![img](file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image014.png)

 

 

The suggested fix is to upgrade the Freemarker dependency to a higher version.
